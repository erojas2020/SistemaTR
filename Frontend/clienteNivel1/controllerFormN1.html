<script>
    // Validar formulario: Nivel 1
   async function validarFormClienteNivel1(form){
      //console.log(form)
      
         event.preventDefault();
      //formularioNivel1.usuario.value= user;   
      var nombre = formularioNivel1.nombre.value;
      var pais = formularioNivel1.pais.value;
      var area = formularioNivel1.area.value;
      var tel = formularioNivel1.telefono.value;
      var email = formularioNivel1.email.value;
      var radioTj = formularioNivel1.radioTj.value;
      var radioFamiliar = formularioNivel1.radioFamiliar.value;
      var radioConfiable = formularioNivel1.radioConfiable.value;
      var terminos = formularioNivel1.terminos.checked;
  
  
      var contenido = "";
  
      if (nombre == ""){
        contenido = "Colocar su nombre completo";
        document.getElementById("nombreNivel1").focus();
        alertaError("true", contenido);
  
      }else if (pais ==""){
        contenido = "Seleccionar su país de Residencia";
        document.getElementById("pais").focus();
        alertaError("true", contenido);
  
      }else if (area == ""){
        contenido = "Seleccionar el código de área de su país";
        document.getElementById("areaNivel1").focus();
        alertaError("true", contenido);
  
      }else if (tel == ""){
        contenido = "Colocar un número de teléfono válido";
        document.getElementById("telefonoNivel1").focus();
        alertaError("true", contenido);    
  
      }else if (!ValidarEmail(email)){
        contenido = "Debe colocar un email válido, no use mayúsculas";
        document.getElementById("emailNivel1").focus();
        alertaError("true", contenido);
        
      } else if (radioTj == ""){
        contenido = "Indique si es Testigo de Jehová";
        document.getElementById("TJSiNivel1").focus();
        alertaError("true", contenido);
  
      }else if (radioFamiliar == ""){ 
        contenido = "Indique si es un Familiar";
        document.getElementById("familiarSiNivel1").focus();
        alertaError("true", contenido);
  
      }else if (radioConfiable == ""){ 
        contenido = "Indique si lo conoce en persona";
        document.getElementById("confiableSiNivel1").focus();
        alertaError("true", contenido);
  
      }else if (terminos==false){
        contenido = "Debe aceptar los terminos y condiciones.";
        document.getElementById("terminosNivel1").focus();
        alertaError("true", contenido);
  
      }else { 
        llamadoDesde = "formN1"
        alertaError("false", "");
        activarSpiner("true", "formN1");
        var resultado = await google.script.run
      .withSuccessHandler( confirmacionRegistroNivel1 )
      .withFailureHandler( mostrarError )
      .registrarNuevoCliente1( form )
  
      }
  
    }
  
    //Confirmación de usuario nivel 1 registrado
    function confirmacionRegistroNivel1(){
      activarSpiner("false", "formN1")
      ocultarElementos("false", ".respuestaPositiva");
      document.getElementById("msjBackend").innerHTML = "Su cliente a sido registrado exitosamente"
      activarModal("true", "#respuestaBackend");
    }
  
  
    //Mensaje de error
    function mostrarError (error) {
      llamadoDesde = ""
      activarSpiner("false", "formN1")
      ocultarElementos("false", ".respuestaNegativa");
      document.getElementById("msjBackend").innerHTML = error
      activarModal("true", "#respuestaBackend");
    }
  
  
    function aceptarTerminos(checkElement){
      var checkterminos = document.getElementById(checkElement);
      checkterminos.checked= true;
    }
  
  
    function rechazarTerminos(checkElement){
      var checkterminos = document.getElementById(checkElement);
      checkterminos.checked= false;
    }
  
  
    function cargarListaPaises(listaPaises){
  
      var select = document.getElementById("pais");
      var select2 = document.getElementById("areaNivel1");
      // select.options.length = 0; 
  
      listaPaises.forEach(element =>{
      var option = document.createElement('option');
      option.value = element[0];
      option.innerHTML = element[1];
      select.appendChild(option)})
  
      listaPaises.forEach(element =>{
      var option = document.createElement('option');
      option.value = element[4];
      option.innerHTML = element[4];
      select2.appendChild(option)})
        
    }
  
    function cerrarFormN1(){
      mostrarContenido("tabN1", "false")
    }
  
  </script>