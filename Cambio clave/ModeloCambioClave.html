<script>

  async function cambiarClavePreguntas(email){
      var resultado = await google.script.run
      .withSuccessHandler( cambiarClaveTrueUser )
      .withFailureHandler( cambiarClaveFalseUser )
      .buscarUsuario(0, email);
  }

  function cambiarClaveTrueUser(datos){
    switch (datos){
      case false:
        activarModal("respuestaNegativa", "Datos no validos")
        break;
      default:
        let preguntas = {
          pregunta1: datos.pregunta1,
          pregunta2: datos.pregunta2
        }
        claveNuevaInsertarPreguntas(preguntas);
        break;  
    }
  }

  function cambiarClaveFalseUser (error){
    activarModal("respuestaNegativa", error)
  }

  async function cambioClaveVerificarRespuestas(respuestas){
    var resultado = await google.script.run
      .withSuccessHandler( cambioClaveTrueRespuesta )
      .withFailureHandler( cambioClaveFalseRespuesta )
      .validarRespuestas(respuestas)
  }

  function cambioClaveTrueRespuesta(validacion) {
    switch(validacion){
      case true:
        showControllerCambioClave()
        break;
      case false:
        activarModal("respuestaNegativa", "Sus respuestas son incorrectas, verifique nuevamente")
        break;  
    }
  }

  function cambioClaveFalseRespuesta(error){
    activarModal("respuestaNegativa", error)
  }

  async function cambiarClaveActualizar(clave){
    var resultado = await google.script.run
      .withSuccessHandler( cambioClaveTrueActualizar )
      .withFailureHandler( cambioClaveFalseActualizar )
      .validarClaveAnterior(clave)
  }

  function cambioClaveTrueActualizar(registrado){
    switch (registrado) {
      case true:
        activarModal("respuestaPositiva","Su contraseña a sido cambiada correctamente")
        break;
      case false:
        activarModal("respuestaNegativa","Su contraseña anterior no es la correcta, verifique e intente de nuevo")
        break;  
    }
  }

  function cambioClaveFalseActualizar(error){
    activarModal("respuestaNegativa", error)
  }



</script>  